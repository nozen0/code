<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="23714291-Nguyenhuuthinh-Tuan08" content="Javascript_jQuery_Form_Modal_Styles">
    <title>Bai1_a</title>
    <link rel="stylesheet" href="../bootstrap-5.0.2-dist/css/bootstrap.min.css">
    <script src="../JS/jquery-3.4.1.min.js"></script>
    <script src="../bootstrap-5.0.2-dist/js/bootstrap.min.js"></script>
    <style>
        .err{
            color: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row" style="text-align: center; margin-top: 100px;">
            <div class="col-12">
                <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#modalID">Đăng ký</button>
            </div>
            <div class="col-12">
                <label for="">Nhấn vào đây để hiện form đăng ký</label>
            </div>
        </div>
        <div class="modal fade" id="modalID">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">

                    <div class="modal-body">
                        <form action="" class="form">
                            <div class="row form-group">
                                <h1 style="text-align: center;">ĐĂNG KÍ TÀI KHOẢN</h1>
                                <div class="col-12">
                                    <label for="">Tên đăng nhập: </label>
                                    <input type="text" id="txtDangNhap" class="form-control" placeholder="txtDN">
                                    <span id="errDangNhap" class="err">(*)</span>
                                </div>
                                <div class="col-12">
                                    <label for="">Mật khẩu: </label>
                                    <input type="password" id="txtMatKhau" class="form-control" placeholder="txtMK">
                                    <span id="errMatKhau" class="err">(*)</span>
                                </div>
                                <div class="col-12">
                                    <label for="">Nhập lại mật khẩu:</label>
                                    <input type="text" id="txtNhapLaiMatKhau" class="form-control" placeholder="txtXNMK">
                                    <span id="errNhapLaiMatKhau" class="err">(*)</span>
                                </div>
                                <h4 style="text-align: center;">THÔNG TIN CÁ NHÂN</h4>
                                <div class="col-12">
                                    <label for="">Họ và tên: </label>
                                    <input type="text" id="txtHoTen" class="form-control" placeholder="txtName">
                                    <span id="errHoTen" class="err">(*)</span>
                                </div>
                                <div class="col-12">
                                    <label for="">Ngày sinh: </label>
                                    <input type="date" id="txtDate" class="form-control">
                                    <span id="errDate" class="err"></span>
                                </div>
                                <div class="col-12">
                                    <label for="">Giới tính: </label>
                                    <input type="radio" name="hinhThuc" checked value="Nam"> Nam
                                    <input type="radio" name="hinhThuc" value="Nữ">Nữ
                                </div>
                                <div class="col-12">
                                    <label for="">Địa chỉ: </label>
                                    <input type="text" name="txtDiaChi" id="txtDiaChi" class="form-control" placeholder="txtDC">
                                    <span id="errDiaChi" class="err"></span>
                                </div>
                                <div class="col-12">
                                    <label for="">Điện thoại: </label>
                                    <input type="text" name="" id="txtDienThoai" class="form-control" placeholder="txtSDT">
                                    <span id="errSDT" class="err"></span>
                                </div>
                                <div class="col-12">
                                    <label for="">Email: </label>
                                    <input type="text" id="txtEmail" class="form-control" placeholder="txtEmail">
                                    <span id="errEmail" class="err"></span>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="row" style="text-align: center;">
                            <div class="col-12">
                                <input type="submit" value="Đăng ký", id="btnDangKy" class="btn btn-dark">
                                <input type="submit" value="Huỷ", id="btnHuy" class="btn btn-dark">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function ktTenDangNhap(){
            let tenDangNhap = $("#txtDangNhap").val().trim();
            let renght = /^([a-zA-Z])([a-zA-Z0-9!@#$%^&*()]*)$/;
            if(tenDangNhap.length == 0){
                $("#errDangNhap").html("Tên đăng nhập không được để trống");
                $("#txtDangNhap").focus();
                return false;
            } else if(renght.test(tenDangNhap)){
                $("#errDangNhap").html("(*)");
                return true;
            }
            else{
                $("#errDangNhap").html("bắt đầu là ký tự, có hoặc không có ký tự số, ký tự đặc biệt và không được có khoảng trắng.");
                $("#txtDangNhap").focus();
                return false;
            }
        }
        $("#txtDangNhap").blur(function(e){
            ktTenDangNhap();
        });

        function ktMatKhau(){
            let matKhau = $("#txtMatKhau").val();
            let renght = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()]).{8,}$/;
            
            if(matKhau == ""){
                $("#errMatKhau").html("Mật khẩu không được để trống");
                return false;
            }else if (renght.test(matKhau)){
                $("#errMatKhau").html("(*)");
                return true;
            }
            else{
                $("#errMatKhau").html("từ 8 ký tự trở lên, có ít nhất 1 ký tự số, 1 ký tự in hoa, 1 ký tự đặc biệt ");
                return false;
            }
        }
        $("#txtMatKhau").blur(function(e){
            ktMatKhau();
        });

        function ktXacNhanLaiMatKhau(){
            let matKhau = $("#txtMatKhau").val();
            let xacNhanMatKhau = $("#txtNhapLaiMatKhau").val();

            if(xacNhanMatKhau == ""){
                $("#errNhapLaiMatKhau").html("Nhập lại mật khẩu không được để trống");
                return false;
            }else if(xacNhanMatKhau == matKhau){
                $("#errNhapLaiMatKhau").html("(*)");
                return true;
            }
            else {
                $("#errNhapLaiMatKhau").html("Mật khẩu không khớp");
                return false;
            }
        }
        $("#txtNhapLaiMatKhau").blur(function(e){
            ktXacNhanLaiMatKhau();
        });

        function ktHoTen(){
            let hoten = $("#txtHoTen").val().trim();
            let renght = /^([A-Z][a-z]*)*([A-Z][a-z]*)$/;

            if(hoten.length == 0){
                $("#errHoTen").html("Họ tên không được để trống");
                $("#txtHoTen").focus();
                return false;
            } else if (renght.test(hoten)){
                $("#errHoTen").html("Họ tên không hợp lệ");
                $("#txtHoTen").focus();
                return false;
            }
            else{
                $("#errHoTen").html("(*)");
                $("#txtHoTen").focus();
                return true;
            }
        }
        $("#txtHoTen").click(function(e){
            ktHoTen();
        });

        function ktTuoi(){
            let tuoi = $("#txtDate").val();
            if(tuoi == "")
            {
                $("#errDate").html("Ngày không được rỗng");
                return false;
            }
            else{
                let ngay = new Date();
                let ngaySinh = new Date(tuoi);
                let age = ngay.getFullYear() - ngaySinh.getFullYear();

                if(ngay.getMonth() < ngaySinh.getMonth() || (ngay.getMonth() == ngaySinh.getMonth() && ngay.getDate() < ngaySinh.getDate())){
                    age--;
                }
                else if(age > 16){
                    $("#errDate").html("(*)");
                    return true;
                }
                else{
                    $("#errDate").html("Tuổi phải trên 16");
                    return false;
                }
            }
        }
        $("#txtDate").blur(function(e){
            ktTuoi();
        });

        function ktDiaChi(){
            let diachi = $("#txtDiaChi").val();

            if(diachi == "")
            {
                $("#errDiaChi").html("Địa chỉ không được rỗng");
                return false;
            }
            else{
                $("#errDiaChi").html("(*)");
                return true;
            }
        }
        $("#txtDiaChi").blur(function(e){
            ktDiaChi();
        });

        function ktSDT(){
            let sodienthoai = $("#txtDienThoai").val();
            let btcq = /^(03|09|07|06|05|04)[0-9]{8}$/;

            if(sodienthoai == ""){
                $("#errSDT").html("Số điện thoại không được rỗng");
                return false;
            }
            else if(btcq.test(sodienthoai)){
                $("#errSDT").html("(*)");
                return true;
            }
            else {
                $("#errSDT").html("Số điện thoại phải có định dạng số đầu phải là 09, 03, 07, 06, 05, 04");
                return false;
            }
        }
        $("#txtDienThoai").blur(function(e){
            ktSDT();
        });

        function ktEmail(){
            let email = $("#txtEmail").val().trim();
            let renght = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if(email.length == 0){
                $("#errEmail").html("Email không được để trống");
                $("#txtEmail").focus();
                return false;
            }
            else if (renght.test(email)){
                $("#errEmail").html("(*)");
                return true;
            }
            else{
                $("#errEmail").html("Email không hơp lệ");
                $("#txtEmail").focus();
                return false;
            }
        }
        $("#txtEmail").blur(function(e){
            ktEmail();
        });
      

       

        $("#btnDangKy").click(function (e) {
            if (ktDiaChi() && ktHoTen && ktTenDangNhap && ktSDT() && ktTuoi()) {

                let hinhThuc = $("input[name='hinhThuc']:checked").val();
                let tendangnhap = $("#txtDangNhap").val()
                let matkhau = $("#txtMatKhau").val();
                let xacnhanmatkhau = $("#txtNhapLaiMatKhau").val();
                let hoTen = $("#txtHoTen").val();
                let tuoi = $("#txtTuoi").val();
                let sdt = $("#txtSDT").val();
                let diachi = $("#txtDiaChi").val();
                let email = $("#txtEmail").val();


                let dv = [];
                $.each($("input[name='dichVu']:checked"), function () {
                    dv.push($(this).val());
                });

                let thanhToan = $("#txtThanhToan").val();

                let tdNew = "<tr><td>" + (i++) + "</td><td>" + hinhThuc + "</td><td>" + maThe + "</td><td>" + hoTen + "</td><td>" + tuoi + "</td><td>" + sdt + "</td><td>" + diachi + "</td><td>" + dv + "</td><td>" + thanhToan + "</td></tr>";

                $("#tableDS").append(tdNew);
                $("#modalID").modal("hide");
                $("#totalRecords").text(i - 1);
            } else {
                alert("Thông tin không hợp lệ");
            }
        });
    </script>
</body>
</html>